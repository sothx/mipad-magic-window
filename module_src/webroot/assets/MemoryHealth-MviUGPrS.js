import{d as e,L as t,aG as a,aH as s,aI as l,aQ as d,aM as i,J as o,aP as r,aO as n,M as c,aL as m,c as g,c0 as u}from"./apis-D1vud7nq.js";import{ay as p,aB as y,aJ as v}from"./hooks-DCDjy9DD.js";import"./lodash-DMrPhC4V.js";const x={class:"memoryHealth"},b={class:"mt-3"},f={class:"px-3 sm:px-0"},k={key:0,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},h={class:"whitespace-pre"},M={key:1,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},D={class:"whitespace-pre"},S={key:2,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},_={key:0,class:"mb-3"},w={class:"mb-3"},I={class:"mb-3"},E={class:"mb-3"},F={key:3,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},B={class:"mb-3"},L={key:0,class:"mb-3"},O={key:1,class:"mb-3"},R={key:2,class:"mb-3"},U={key:4,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},A={key:0,class:"mt-1"},C=e({__name:"MemoryHealth",setup(e){const C=t(),T=p(),V=y(),$=v(),z=({focused:e,checked:t})=>{const a={};return t?(a.background="#d03050",e&&(a.boxShadow="0 0 0 2px #d0305040")):(a.background="#2080f0",e&&(a.boxShadow="0 0 0 2px #2080f040")),a};return(e,t)=>{const p=a("n-tag"),y=a("n-alert"),v=a("n-button"),W=a("n-switch");return s(),l("div",x,[d("div",b,[d("div",f,[t[5]||(t[5]=d("h3",{class:i("text-base font-semibold leading-7")},[d("span",{class:"animated-bg bg-clip-text font-semibold text-transparent",style:{"background-image":"linear-gradient(\r\n\t\t\t\t\t\t\t\t101.22deg,\r\n\t\t\t\t\t\t\t\trgb(255, 182, 133) -18.32%,\r\n\t\t\t\t\t\t\t\trgb(255, 111, 29) 7.01%,\r\n\t\t\t\t\t\t\t\trgb(252, 181, 232) 41.59%,\r\n\t\t\t\t\t\t\t\trgb(135, 148, 255) 70.98%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 91.35%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 110.17%\r\n\t\t\t\t\t\t\t)"}},"存储健康")],-1)),d("p",{class:i("mt-1 max-w-2xl text-sm leading-6 "+(o(C).isDarkMode?"text-gray-300":"text-gray-500"))}," 存储健康，提供存储状态监测与优化管理。 ",2)]),d("div",{class:i("mt-3 border-t "+(o(C).isDarkMode?"divide-sothx-gray-color border-sothx-gray-color":"divide-gray-200 border-gray-200"))},[d("dl",{class:i("divide-y "+(o(C).isDarkMode?"divide-sothx-gray-color":"divide-gray-200"))},[o(C).deviceInfo.memoryInfo?(s(),l("div",k,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(C).isDarkMode?"text-white":"text-gray-900"))}," 设备DDR和UFS信息 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(C).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",h,r(o(C).deviceInfo.memoryInfo||"获取失败"),1)],2)])):n("",!0),o(C).DDRVendor?(s(),l("div",M,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(C).isDarkMode?"text-white":"text-gray-900"))}," 设备DDR生产厂商 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(C).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",D,r(o(C).DDRVendor),1)],2)])):n("",!0),o(C).MIOSVersion&&o(C).MIOSVersion>=2&&o(C).androidTargetSdk>=35&&o(T).isInit.value?(s(),l("div",S,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(C).isDarkMode?"text-white":"text-gray-900"))},"ZRAM Writeback",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(C).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[o(C).MIOSVersion&&o(C).MIOSVersion>=2&&o(C).androidTargetSdk>=35?(s(),l("div",_,[c(p,null,{default:m((()=>[g("dm设备映射器: "+r(o(T).miuiExtmDmOptEnable.value?"启用":"未启用"),1)])),_:1})])):n("",!0),d("div",w,[c(p,{type:"error"},{default:m((()=>[g("回写块: "+r(o(T).backingDev.value),1)])),_:1})]),d("div",I,[c(p,{type:"success"},{default:m((()=>[g("已回写: "+r(o(T).hasWriteBack.value)+" MB",1)])),_:1})]),d("div",E,[c(p,{type:"info"},{default:m((()=>[g("总读取: "+r(o(T).totalRead.value)+" MB",1)])),_:1})]),d("div",null,[c(p,{type:"warning"},{default:m((()=>[g("总回写: "+r(o(T).totalWriteBack.value)+" MB",1)])),_:1})]),c(y,{class:"mt-5",type:"warning","show-icon":!1,bordered:!1},{default:m((()=>t[6]||(t[6]=[d("p",null,"通常用于将设备上的冷数据压缩并迁移到磁盘上，是基于「内存扩展」的回写块，该功能依赖「内存扩展」，请确保已经开启「内存扩展」，总回写可以大于「内存扩展」，初始状态下显示 0 MB是正常现象，请持续使用一段时间再观察是否有变化",-1)]))),_:1})],2)])):n("",!0),o(V).isShow.value?(s(),l("div",F,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(C).isDarkMode?"text-white":"text-gray-900"))}," UFS 存储健康 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(C).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",B,[o(V).correctedPreEOLStatus.value?(s(),l("div",L,[c(p,{type:"info"},{default:m((()=>[g("寿命阶段: "+r(o(V).correctedPreEOLStatus.value),1)])),_:1})])):n("",!0),o(V).deviceLifeTimeEstA.value?(s(),l("div",O,[c(p,{type:"success"},{default:m((()=>[g("用户数据区(已磨损): "+r(o(V).deviceLifeTimeEstA.value),1)])),_:1})])):n("",!0),o(V).deviceLifeTimeEstB.value?(s(),l("div",R,[c(p,{type:"warning"},{default:m((()=>[g("高速缓存区(已磨损): "+r(o(V).deviceLifeTimeEstB.value),1)])),_:1})])):n("",!0)]),c(y,{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:m((()=>t[7]||(t[7]=[d("p",null,"数据仅供参考，通常仅代表当前 UFS 存储设备循环擦写次数与预期设计寿命的比值，不代表 UFS 存储设备的实际磨损状况，但仍然建议当前 UFS 存储设备接近预期设计寿命时选择更换存储设备。",-1)]))),_:1})],2)])):n("",!0),o($).isInit.value?(s(),l("div",U,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(C).isDarkMode?"text-white":"text-gray-900"))}," 焕新存储 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(C).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[c(v,{size:"small",type:"info",secondary:"",loading:o(C).loading,onClick:t[0]||(t[0]=()=>u())},{default:m((()=>t[8]||(t[8]=[g(" 打开 焕新存储信息面板 ")]))),_:1},8,["loading"]),c(y,{class:"mb-5 mt-5",type:"success","show-icon":!1,bordered:!1},{default:m((()=>[d("div",null,[d("p",null,[t[9]||(t[9]=g("焕新存储启用状态:")),c(v,{size:"tiny",class:"ml-3",type:o($).fboEnable.value?"success":"error",loading:o(C).loading,onClick:t[1]||(t[1]=()=>o($).handleEnableFbo())},{default:m((()=>[g(r(o($).fboEnable.value?"已启用":"未启用(点击启用)"),1)])),_:1},8,["type","loading"])]),t[12]||(t[12]=d("p",null,"启用状态通常由小米云控控制，模块支持强制启用焕新存储，但该功能受系统底层支持情况而异，不支持的设备即使启用也不会生效。",-1)),c(W,{"onUpdate:value":t[2]||(t[2]=e=>o($).changeIsAutoEnableFbo(e)),"rail-style":z,value:!!o($).isAutoStartFbo.value,loading:o(C).loading},{checked:m((()=>t[10]||(t[10]=[g("已强制启用焕新存储")]))),unchecked:m((()=>t[11]||(t[11]=[g("跟随系统默认云控规则")]))),_:1},8,["value","loading"])])])),_:1}),c(y,{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:m((()=>[d("p",null,[t[13]||(t[13]=g("焕新存储激活状态: ")),c(v,{size:"tiny",class:"ml-3",type:o($).fboServiceCtrl.value?"success":"error",loading:o(C).loading,onClick:t[3]||(t[3]=()=>o($).handleEnableFboServiceCtrl())},{default:m((()=>[g(r(o($).fboServiceCtrl.value?"已激活":"未激活(点击激活)"),1)])),_:1},8,["type","loading"])]),o($).fboInstalld.value?(s(),l("p",A,[t[14]||(t[14]=g("焕新存储运行状态:")),c(p,{size:"small",class:"ml-3",type:"info",loading:o(C).loading,onClick:()=>{}},{default:m((()=>[g(r(o($).fboInstalld.value),1)])),_:1},8,["loading"])])):n("",!0),t[17]||(t[17]=d("p",null,"激活后仍然需要满足以下条件才会在特定时间触发焕新存储：",-1)),t[18]||(t[18]=d("p",null,"①夜间12点半-凌晨5点",-1)),t[19]||(t[19]=d("p",null,"②息屏状态",-1)),t[20]||(t[20]=d("p",null,"③电量大于75%(或保持手机充电)",-1)),t[21]||(t[21]=d("p",null,"④电池温度小于40℃",-1)),t[22]||(t[22]=d("p",null,"进行焕新存储期间检测到其中任意条件不满足，焕新存储会被中断，待满足后继续执行，当满足上述4个条件后，此功能也并不是每天都生效，需要文件碎片累积到一定程度会主动进行。",-1)),t[23]||(t[23]=d("p",null,"（焕新存储流程结束后，激活状态会被关闭，您可以前往Web UI 重新激活）",-1)),c(W,{"onUpdate:value":t[4]||(t[4]=e=>o($).changeIsAutoRegularlyFbo(e)),"rail-style":z,value:!!o($).isAutoRegularlyFbo.value,loading:o(C).loading},{checked:m((()=>t[15]||(t[15]=[g("已启用每日闲时维护")]))),unchecked:m((()=>t[16]||(t[16]=[g("未启用每日闲时维护")]))),_:1},8,["value","loading"])])),_:1})],2)])):n("",!0)],2)],2)])])}}});export{C as default};
