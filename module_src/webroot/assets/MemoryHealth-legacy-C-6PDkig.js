System.register(["./apis-legacy-WIMWY0qw.js","./hooks-legacy-D28Whc5D.js","./RenderJSX-legacy-ByLlhTZO.js","./XCircleIcon-legacy-slGlFVGs.js","./lodash-legacy-FWutsFSa.js"],function(t,n){"use strict";var e,l,r,u,a,o,i,c,s,d,f,v,g,p,b,m,y,h,S,w,I,k,x,O,B,D,C,F;return{setters:[function(t){e=t.d,l=t.L,r=t.r,u=t.b,a=t.U,o=t.b4,i=t.b5,c=t.b6,s=t.be,d=t.bc,f=t.J,v=t.b9,g=t.F,p=t.c6,b=t.c,m=t.ba,y=t.bb,h=t.bd,S=t.k,w=t.v,I=t.cy},function(t){k=t.ay,x=t.aC,O=t.aB,B=t.aO},function(t){D=t.R},function(t){C=t.r,F=t.a},null],execute:function(){var n={class:"memoryHealth"},M={class:"mt-3"},E={class:"px-3 sm:px-0"},L={class:"flex"};t("default",e({__name:"MemoryHealth",setup:function(t){var e=l(),_=k(),z=x(),U=O(),R=B(),A=r(""),T=r(null),V=function(t){var n=t.focused,e={};return t.checked?(e.background="#d03050",n&&(e.boxShadow="0 0 0 2px #d0305040")):(e.background="#2080f0",n&&(e.boxShadow="0 0 0 2px #2080f040")),e},j=[{title:"设备DDR和UFS信息",content:function(){return a("div",{class:"whitespace-pre"},[e.deviceInfo.memoryInfo||"获取失败"])},isShow:function(){return Boolean(e.deviceInfo.memoryInfo)}},{title:"设备DDR生产厂商",content:function(){return a("div",{class:"whitespace-pre"},[e.DDRVendor])},isShow:function(){return Boolean(e.DDRVendor)}},{title:"ZRAM Writeback",content:function(){return a(g,null,[a("div",{class:"mb-3"},[a(o("n-tag"),null,{default:function(){return[b("dm设备映射器: "),_.miuiExtmDmOptEnable.value?"已生效":"未生效"]}})]),a("div",{class:"mb-3"},[a(o("n-tag"),{type:"error"},{default:function(){return[b("回写块: "),_.backingDev.value,b(" ")]}})]),a("div",{class:"mb-3"},[a(o("n-tag"),{type:"success"},{default:function(){return[b("已回写: "),_.hasWriteBack.value,b(" MB")]}})]),a("div",{class:"mb-3"},[a(o("n-tag"),{type:"info"},{default:function(){return[b("总读取: "),_.totalRead.value,b(" MB")]}})]),a("div",null,[a(o("n-tag"),{type:"warning"},{default:function(){return[b("总回写: "),_.totalWriteBack.value,b(" MB")]}})]),a(o("n-alert"),{class:"mt-5",type:"warning","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("通常用于将设备上的冷数据压缩并迁移到磁盘上，是基于「内存扩展」的回写块，该功能依赖「内存扩展」，请确保已经开启「内存扩展」，总回写可以大于「内存扩展」，初始状态下显示 0 MB是正常现象，请持续使用一段时间再观察是否有变化")])]}})])},isShow:function(){return Boolean(e.MIOSVersion&&e.MIOSVersion>=2&&e.androidTargetSdk>=35&&_.isInit.value)}},{title:"智能IO调度",content:function(){var t,n,e,l=(t=U.currentScheduler.value,n=U.smartFocusIO.value,e=U.currentPropScheduler.value,"cpq"===t?"success":"on"===n&&e&&"cpq"!==e?"warning":"error");return a(g,null,[a(o("n-tag"),{type:l},{default:function(){return["success"===l?"已启用智能IO调度 [cpq]":"warning"===l?"已被模块磁盘IO调度覆盖 [".concat(U.currentScheduler.value,"]"):"未启用智能IO调度"]}}),a(o("n-alert"),{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("「智能IO调度 cpq」是小米基于「Linux磁盘IO调度 bfq」二次优化改进的版本，一般情况下建议启用，可以一定程度提升系统的IO性能体验。")])]}}),U.isNeedShowModuleTips.value&&a(o("n-alert"),{class:"mt-5",type:"warning","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("您当前未启用「智能IO调度」，由于小米「磁盘IO调度」BUG，骁龙8+Gen1机型存在IO调度异常的问题， 容易导致系统卡顿或者无响应，您可以通过安装「精选应用-系统功能补全模块」来启用「智能IO调度」，提升系统IO性能体验。")])]}})])},isShow:function(){return Boolean(U.isSupportSmartFocusIO.value)}},{title:"磁盘IO调度策略",content:function(){return a(g,null,[a("div",{class:"grid grid-cols-2 gap-4 sm:px-0"},[Array.isArray(U.schedulerList.value)&&U.schedulerList.value.map(function(t,n){var l=function(t){var n=U.currentScheduler.value,e=U.currentPropScheduler.value;return e||n!==t?e===t&&n===t?"success":e&&n&&e!==n&&n===t?"warning":"info":"error"},r=l(t);return a(o("n-alert"),{size:"small","show-icon":!1,type:l(t),title:t,class:"w-full"},{default:function(){return[["error"].includes(r)?a(o("n-tag"),{class:"mt-2",bordered:!1,type:r},{default:function(){return[a("div",null,[b("系统默认磁盘调度")])]}}):S(a(o("n-button"),{class:"mt-2",strong:!0,secondary:!0,type:r,loading:e.loading||U.loading.value,size:"small",onClick:function(){return U.changeIOScheduler(t)}},{default:function(){return["success"===r?"已应用该配置":"warning"===r?"异常的磁盘调度":"应用配置"]}}),[[w,U.isInit.value]])]}})})]),a(o("n-alert"),{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("这里会显示系统所支持的所有磁盘IO调度策略，方便您灵活切换设备的磁盘IO调度策略")]),a("p",null,[b("(受系统实际支持情况影响，切换其他磁盘IO调度策略可能会导致系统出现未知异常，请自行准备救砖模块)")])]}})])},isShow:function(){return Boolean(U.isShowList.value)}},{title:"UFS 存储健康",content:function(){return a(g,null,[a("div",{class:"mb-3"},[z.correctedPreEOLStatus.value&&a("div",{class:"mb-3"},[a(o("n-tag"),{type:"info"},{default:function(){return[b("寿命阶段: "),z.correctedPreEOLStatus.value]}})]),z.deviceLifeTimeEstA.value&&a("div",{class:"mb-3"},[a(o("n-tag"),{type:"success"},{default:function(){return[b("用户数据区(已磨损): "),z.deviceLifeTimeEstA.value]}})]),z.deviceLifeTimeEstB.value&&a("div",{class:"mb-3"},[a(o("n-tag"),{type:"warning"},{default:function(){return[b("高速缓存区(已磨损): "),z.deviceLifeTimeEstB.value]}})])]),a(o("n-alert"),{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("数据仅供参考，通常仅代表当前 UFS 存储设备循环擦写次数与预期设计寿命的比值，不代表 UFS 存储设备的实际磨损状况，但仍然建议当前 UFS 存储设备接近预期设计寿命时选择更换存储设备。")])]}})])},isShow:function(){return Boolean(z.isShow.value)}},{title:"焕新存储",content:function(){return a(g,null,[a(o("n-button"),{size:"small",type:"info",secondary:!0,loading:e.loading,onClick:function(){return I()}},{default:function(){return[b("打开 焕新存储信息面板")]}}),a(o("n-alert"),{class:"mb-5 mt-5",type:"success","show-icon":!1,bordered:!1},{default:function(){return[a("div",null,[a("p",null,[b("焕新存储启用状态:"),a(o("n-button"),{size:"tiny",class:"ml-3",type:R.fboEnable.value?"success":"error",loading:e.loading,onClick:function(){return R.handleEnableFbo()}},{default:function(){return[R.fboEnable.value?"已启用":"未启用(点击启用)"]}})]),a("p",null,[b("启用状态通常由小米云控控制，模块支持强制启用焕新存储，但该功能受系统底层支持情况而异，不支持的设备即使启用也不会生效。")]),a(o("n-switch"),{onUpdateValue:function(t){return R.changeIsAutoEnableFbo(t)},"rail-style":V,value:!!R.isAutoStartFbo.value,loading:e.loading},{checked:function(){return a(g,null,[b("已强制启用焕新存储")])},unchecked:function(){return a(g,null,[b("跟随系统默认云控规则")])}})])]}}),a(o("n-alert"),{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:function(){return[a("p",null,[b("焕新存储激活状态:"),a(o("n-button"),{size:"tiny",class:"ml-3",type:R.fboServiceCtrl.value?"success":"error",loading:e.loading,onClick:function(){return R.handleEnableFboServiceCtrl()}},{default:function(){return[R.fboServiceCtrl.value?"已激活":"未激活(点击激活)"]}})]),R.fboInstalld.value&&a("p",{class:"mt-1"},[b("焕新存储运行状态:"),a(o("n-tag"),{size:"small",class:"ml-3",type:"info",loading:e.loading,onClick:function(){}},{default:function(){return[R.fboInstalld.value]}})]),a("p",null,[b("激活后仍然需要满足以下条件才会在特定时间触发焕新存储：")]),a("p",null,[b("①夜间12点半-凌晨5点")]),a("p",null,[b("②息屏状态")]),a("p",null,[b("③电量大于75%(或保持手机充电)")]),a("p",null,[b("④电池温度小于40℃")]),a("p",null,[b("进行焕新存储期间检测到其中任意条件不满足，焕新存储会被中断，待满足后继续执行，当满足上述4个条件后，此功能也并不是每天都生效，需要文件碎片累积到一定程度会主动进行。")]),a("p",null,[b("（焕新存储流程结束后，激活状态会被关闭，您可以前往Web UI 重新激活）")]),a(o("n-switch"),{onUpdateValue:function(t){return R.changeIsAutoRegularlyFbo(t)},"rail-style":V,value:!!R.isAutoRegularlyFbo.value,loading:e.loading},{checked:function(){return a(g,null,[b("已启用每日闲时维护")])},unchecked:function(){return a(g,null,[b("未启用每日闲时维护")])}})]}})])},isShow:function(){return Boolean(R.isInit.value)}}],q=u(function(){var t=A.value.trim().toLowerCase();return j.filter(function(n){return!(n.isShow&&!n.isShow())&&(!t||n.title.toLowerCase().includes(t))})});return function(t,l){var r=o("n-input"),u=o("n-icon"),S=o("n-button"),w=o("n-input-group"),I=o("n-card");return c(),i("div",n,[s("div",M,[s("div",E,[l[3]||(l[3]=s("h3",{class:d("text-base font-semibold leading-7")},[s("span",{class:"animated-bg bg-clip-text font-semibold text-transparent",style:{"background-image":"linear-gradient(\r\n\t\t\t\t\t\t\t\t101.22deg,\r\n\t\t\t\t\t\t\t\trgb(255, 182, 133) -18.32%,\r\n\t\t\t\t\t\t\t\trgb(255, 111, 29) 7.01%,\r\n\t\t\t\t\t\t\t\trgb(252, 181, 232) 41.59%,\r\n\t\t\t\t\t\t\t\trgb(135, 148, 255) 70.98%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 91.35%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 110.17%\r\n\t\t\t\t\t\t\t)"}},"存储健康")],-1)),s("p",{class:d("mt-1 max-w-2xl text-sm leading-6 ".concat(f(e).isDarkMode?"text-gray-300":"text-gray-500"))}," 存储健康，提供存储状态监测与优化管理。 ",2)]),a(I,{size:"small",class:"mt-5"},{default:v(function(){return[s("div",L,[a(w,null,{default:v(function(){return[a(r,{size:"large",clearable:"",value:A.value,"onUpdate:value":l[0]||(l[0]=function(t){return A.value=t}),ref_key:"searchKeyWordInput",ref:T,placeholder:"搜索功能名称",class:"w-4/5"},null,8,["value"]),a(S,{size:"large",type:"primary",onClick:l[1]||(l[1]=function(){var t;null===(t=T.value)||void 0===t||t.blur()})},{icon:v(function(){return[a(u,null,{default:v(function(){return[a(f(C))]}),_:1})]}),default:v(function(){return[l[4]||(l[4]=s("span",{class:"hidden sm:inline-block"},"搜索",-1))]}),_:1,__:[4]}),a(S,{size:"large",bordered:"",onClick:l[2]||(l[2]=function(){A.value=""})},{icon:v(function(){return[a(u,null,{default:v(function(){return[a(f(F))]}),_:1})]}),default:v(function(){return[l[5]||(l[5]=s("span",{class:"hidden sm:inline-block"},"清空",-1))]}),_:1,__:[5]})]}),_:1})])]}),_:1}),s("div",{class:d("mt-3 border-t ".concat(f(e).isDarkMode?"divide-sothx-gray-color border-sothx-gray-color":"divide-gray-200 border-gray-200"))},[s("dl",{class:d("divide-y ".concat(f(e).isDarkMode?"divide-sothx-gray-color":"divide-gray-200"))},[(c(!0),i(g,null,p(q.value,function(t,n){return c(),i("div",{key:n,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},[s("dt",{class:d("text-sm font-medium leading-6 ".concat(f(e).isDarkMode?"text-white":"text-gray-900"))},[b(h(t.title)+" ",1),t.titleSlot?(c(),m(f(D),{key:0,content:t.titleSlot&&t.titleSlot()},null,8,["content"])):y("",!0)],2),s("dd",{class:d("mt-1 text-sm leading-6 ".concat(f(e).isDarkMode?"text-gray-300":"text-gray-700"," sm:col-span-2 sm:mt-0"))},[t.content?(c(),m(f(D),{key:0,content:t.content&&t.content()},null,8,["content"])):y("",!0)],2)])}),128))],2)],2)])])}}}))}}});
