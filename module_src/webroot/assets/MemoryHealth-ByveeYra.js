import{D as t,u as e,ah as a,ai as s,aj as l,at as d,ao as i,ap as o,as as r,ar as n,a as c,an as m,b as g,b_ as u}from"./apis-BBzH6gLY.js";import{I as p,L as y,Y as v}from"./hooks-Ba32akuV.js";import"./lodash-DMrPhC4V.js";import"./naive-ui-BM6VJ1CJ.js";const x={class:"memoryHealth"},b={class:"mt-3"},f={class:"px-3 sm:px-0"},k={key:0,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},h={class:"whitespace-pre"},D={key:1,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},M={class:"whitespace-pre"},_={key:2,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},S={key:0,class:"mb-3"},w={class:"mb-3"},I={class:"mb-3"},E={class:"mb-3"},F={key:3,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},B={class:"mb-3"},R={key:0,class:"mb-3"},U={key:1,class:"mb-3"},A={key:2,class:"mb-3"},C={key:4,class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},L={key:0,class:"mt-1"},O=t({__name:"MemoryHealth",setup(t){const O=e(),T=p(),V=y(),j=v(),$=({focused:t,checked:e})=>{const a={};return e?(a.background="#d03050",t&&(a.boxShadow="0 0 0 2px #d0305040")):(a.background="#2080f0",t&&(a.boxShadow="0 0 0 2px #2080f040")),a};return(t,e)=>{const p=a("n-tag"),y=a("n-alert"),v=a("n-button"),z=a("n-switch");return s(),l("div",x,[d("div",b,[d("div",f,[e[5]||(e[5]=d("h3",{class:i("text-base font-semibold leading-7")},[d("span",{class:"animated-bg bg-clip-text font-semibold text-transparent",style:{"background-image":"linear-gradient(\r\n\t\t\t\t\t\t\t\t101.22deg,\r\n\t\t\t\t\t\t\t\trgb(255, 182, 133) -18.32%,\r\n\t\t\t\t\t\t\t\trgb(255, 111, 29) 7.01%,\r\n\t\t\t\t\t\t\t\trgb(252, 181, 232) 41.59%,\r\n\t\t\t\t\t\t\t\trgb(135, 148, 255) 70.98%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 91.35%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 110.17%\r\n\t\t\t\t\t\t\t)"}},"存储健康")],-1)),d("p",{class:i("mt-1 max-w-2xl text-sm leading-6 "+(o(O).isDarkMode?"text-gray-300":"text-gray-500"))}," 存储健康，提供存储状态监测与优化管理。 ",2)]),d("div",{class:i("mt-3 border-t "+(o(O).isDarkMode?"divide-sothx-gray-color border-sothx-gray-color":"divide-gray-200 border-gray-200"))},[d("dl",{class:i("divide-y "+(o(O).isDarkMode?"divide-sothx-gray-color":"divide-gray-200"))},[o(O).deviceInfo.memoryInfo?(s(),l("div",k,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(O).isDarkMode?"text-white":"text-gray-900"))}," 设备DDR和UFS信息 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(O).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",h,r(o(O).deviceInfo.memoryInfo||"获取失败"),1)],2)])):n("",!0),o(O).DDRVendor?(s(),l("div",D,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(O).isDarkMode?"text-white":"text-gray-900"))}," 设备DDR生产厂商 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(O).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",M,r(o(O).DDRVendor),1)],2)])):n("",!0),o(O).MIOSVersion&&o(O).MIOSVersion>=2&&o(O).androidTargetSdk>=35&&o(T).isInit.value?(s(),l("div",_,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(O).isDarkMode?"text-white":"text-gray-900"))},"ZRAM Writeback",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(O).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[o(O).MIOSVersion&&o(O).MIOSVersion>=2&&o(O).androidTargetSdk>=35?(s(),l("div",S,[c(p,null,{default:m((()=>[g("dm设备映射器: "+r(o(T).miuiExtmDmOptEnable?"启用":"未启用"),1)])),_:1})])):n("",!0),d("div",w,[c(p,{type:"error"},{default:m((()=>[g("回写块: "+r(o(T).backingDev),1)])),_:1})]),d("div",I,[c(p,{type:"success"},{default:m((()=>[g("已回写: "+r(o(T).hasWriteBack)+" MB",1)])),_:1})]),d("div",E,[c(p,{type:"info"},{default:m((()=>[g("总读取: "+r(o(T).totalRead)+" MB",1)])),_:1})]),d("div",null,[c(p,{type:"warning"},{default:m((()=>[g("总回写: "+r(o(T).totalWriteBack)+" MB",1)])),_:1})]),c(y,{class:"mt-5",type:"warning","show-icon":!1,bordered:!1},{default:m((()=>e[6]||(e[6]=[d("p",null,"通常用于将设备上的冷数据压缩并迁移到磁盘上，是基于「内存扩展」的回写块，该功能依赖「内存扩展」，请确保已经开启「内存扩展」，总回写可以大于「内存扩展」，初始状态下显示 0 MB是正常现象，请持续使用一段时间再观察是否有变化",-1)]))),_:1})],2)])):n("",!0),o(V).isShow.value?(s(),l("div",F,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(O).isDarkMode?"text-white":"text-gray-900"))}," UFS 存储健康 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(O).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[d("div",B,[o(V).correctedPreEOLStatus.value?(s(),l("div",R,[c(p,{type:"info"},{default:m((()=>[g("寿命阶段: "+r(o(V).correctedPreEOLStatus.value),1)])),_:1})])):n("",!0),o(V).deviceLifeTimeEstA.value?(s(),l("div",U,[c(p,{type:"success"},{default:m((()=>[g("用户数据区(已磨损): "+r(o(V).deviceLifeTimeEstA.value),1)])),_:1})])):n("",!0),o(V).deviceLifeTimeEstB.value?(s(),l("div",A,[c(p,{type:"warning"},{default:m((()=>[g("高速缓存区(已磨损): "+r(o(V).deviceLifeTimeEstB.value),1)])),_:1})])):n("",!0)]),c(y,{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:m((()=>e[7]||(e[7]=[d("p",null,"数据仅供参考，通常仅代表当前 UFS 存储设备循环擦写次数与预期设计寿命的比值，不代表 UFS 存储设备的实际磨损状况，但仍然建议当前 UFS 存储设备接近预期设计寿命时选择更换存储设备。",-1)]))),_:1})],2)])):n("",!0),o(j).isInit.value?(s(),l("div",C,[d("dt",{class:i("text-sm font-medium leading-6 "+(o(O).isDarkMode?"text-white":"text-gray-900"))}," 焕新存储 ",2),d("dd",{class:i(`mt-1 text-sm leading-6 ${o(O).isDarkMode?"text-gray-300":"text-gray-700"} sm:col-span-2 sm:mt-0`)},[c(v,{size:"small",type:"info",secondary:"",loading:o(O).loading,onClick:e[0]||(e[0]=()=>u())},{default:m((()=>e[8]||(e[8]=[g(" 打开 焕新存储信息面板 ")]))),_:1},8,["loading"]),c(y,{class:"mb-5 mt-5",type:"success","show-icon":!1,bordered:!1},{default:m((()=>[d("div",null,[d("p",null,[e[9]||(e[9]=g("焕新存储启用状态:")),c(v,{size:"tiny",class:"ml-3",type:o(j).fboEnable.value?"success":"error",loading:o(O).loading,onClick:e[1]||(e[1]=()=>o(j).handleEnableFbo())},{default:m((()=>[g(r(o(j).fboEnable.value?"已启用":"未启用(点击启用)"),1)])),_:1},8,["type","loading"])]),e[12]||(e[12]=d("p",null,"启用状态通常由小米云控控制，模块支持强制启用焕新存储，但该功能受系统底层支持情况而异，不支持的设备即使启用也不会生效。",-1)),c(z,{"onUpdate:value":e[2]||(e[2]=t=>o(j).changeIsAutoEnableFbo(t)),"rail-style":$,value:!!o(j).isAutoStartFbo.value,loading:o(O).loading},{checked:m((()=>e[10]||(e[10]=[g("已强制启用焕新存储")]))),unchecked:m((()=>e[11]||(e[11]=[g("跟随系统默认云控规则")]))),_:1},8,["value","loading"])])])),_:1}),c(y,{class:"mt-5",type:"info","show-icon":!1,bordered:!1},{default:m((()=>[d("p",null,[e[13]||(e[13]=g("焕新存储激活状态: ")),c(v,{size:"tiny",class:"ml-3",type:o(j).fboServiceCtrl.value?"success":"error",loading:o(O).loading,onClick:e[3]||(e[3]=()=>o(j).handleEnableFboServiceCtrl())},{default:m((()=>[g(r(o(j).fboServiceCtrl.value?"已激活":"未激活(点击激活)"),1)])),_:1},8,["type","loading"])]),o(j).fboInstalld.value?(s(),l("p",L,[e[14]||(e[14]=g("焕新存储运行状态:")),c(p,{size:"small",class:"ml-3",type:"info",loading:o(O).loading,onClick:()=>{}},{default:m((()=>[g(r(o(j).fboInstalld.value),1)])),_:1},8,["loading"])])):n("",!0),e[17]||(e[17]=d("p",null,"激活后仍然需要满足以下条件才会在特定时间触发焕新存储：",-1)),e[18]||(e[18]=d("p",null,"①夜间12点半-凌晨5点",-1)),e[19]||(e[19]=d("p",null,"②息屏状态",-1)),e[20]||(e[20]=d("p",null,"③电量大于75%(或保持手机充电)",-1)),e[21]||(e[21]=d("p",null,"④电池温度小于40℃",-1)),e[22]||(e[22]=d("p",null,"进行焕新存储期间检测到其中任意条件不满足，焕新存储会被中断，待满足后继续执行，当满足上述4个条件后，此功能也并不是每天都生效，需要文件碎片累积到一定程度会主动进行。",-1)),e[23]||(e[23]=d("p",null,"（焕新存储流程结束后，激活状态会被关闭，您可以前往Web UI 重新激活）",-1)),c(z,{"onUpdate:value":e[4]||(e[4]=t=>o(j).changeIsAutoRegularlyFbo(t)),"rail-style":$,value:!!o(j).isAutoRegularlyFbo.value,loading:o(O).loading},{checked:m((()=>e[15]||(e[15]=[g("已启用每日闲时维护")]))),unchecked:m((()=>e[16]||(e[16]=[g("未启用每日闲时维护")]))),_:1},8,["value","loading"])])),_:1})],2)])):n("",!0)],2)],2)])])}}});export{O as default};
