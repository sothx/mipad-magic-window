import{_ as t}from"./all_app-D39sbeUz.js";import{d as e,u as a,a as l}from"./index-DuZ4yc8H.js";import{ba as o,bb as s,bj as i,d as n,r,L as c,b as p,ac as d,h as u,b9 as g,V as m,bh as k,J as y,be as b,bg as f,bi as v,bf as L,M as w,dt as x,bT as D,c as B,cN as T,du as h,dv as C,ab as _,l as M,cO as j,cM as P}from"./apis-CyfUCL2x.js";import{B as S,as as Q,x as I,y as U,z,av as A,F as N,ak as H,U as R}from"./hooks-sEaDI6WG.js";import{_ as W}from"./DotBlackListAppDrawer.vue_vue_type_script_setup_true_lang-CSkADD7_.js";import{b as O,a as E}from"./format-D_OGebxR.js";import{p as K}from"./pako-__J333JV.js";import{r as V}from"./PlusIcon-WWaD6QXy.js";import{r as F}from"./ArrowPathIcon-Cj5CMOGo.js";import{r as J,a as Z,b as X,c as q}from"./FunnelIcon-DgfXgZhV.js";import{r as $,a as G}from"./QuestionMarkCircleIcon-C_QcVRJX.js";import{r as Y}from"./ShareIcon-DiKYgMN_.js";import{r as tt,a as et}from"./XCircleIcon-C7knBI56.js";import"./iconfont-CKH9wMaD.js";import"./lodash-CIZQSGu2.js";function at(t,e){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 8.25V18a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 21 18V8.25m-18 0V6a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 6v2.25m-18 0h18M5.25 6h.008v.008H5.25V6ZM7.5 6h.008v.008H7.5V6Zm2.25 0h.008v.008H9.75V6Z"})])}const lt={class:"autoui-view mb-10"},ot={class:"mt-3"},st={class:"mb-3 px-4 sm:px-0"},it={key:0,class:"mb-3 flex flex-wrap"},nt={key:1,"show-icon":!0,class:"mb-3 flex flex-wrap"},rt={class:"mt-3"},ct={class:"flex flex-wrap"},pt={class:"flex flex-wrap"},dt=n({__name:"DotBlackListView",setup(n){const dt=r(null),ut=[{title:"应用名称",minWidth:250,key:"name",render:(t,e)=>m("div",null,[t.applicationName&&m("p",null,[t.applicationName]),t.name&&m("p",null,[m("span",{class:{hidden:!t.applicationName}},[B("(")]),t.name,m("span",{class:{hidden:!t.applicationName}},[B(")")])])])},{title:"规则状态",width:150,key:"isOptimizeWebView",render:(t,e)=>t.status||Lt.isSupportProjectTrebleCustomDotBlackList&&Lt.isEnableProjectTrebleCustomDotBlackList?m(g("n-tag"),{bordered:!1,dashed:!0,type:"success"},{default:()=>[B("已生效")]}):m(g("n-tag"),{bordered:!1,dashed:!0,type:"info"},{default:()=>[B("未生效")]})},{title:"规则来源",width:150,key:"ruleMode",render(t,e){const a={icon:"custom"===t.ruleMode?q:G};if("custom"===t.ruleMode){const e=[{label:"分享自定义规则",key:"shareCustomRule",icon:Tt(m("svg",{class:"icon","aria-hidden":"true"},[m("use",{"xlink:href":"#icon-fenxiang"},null)]),20)},{label:"清除自定义规则",key:"cleanCustomRule",icon:Tt(m("svg",{class:"icon","aria-hidden":"true"},[m("use",{"xlink:href":"#icon-qingchu"},null)]),20)}];return m(g("n-dropdown"),{onSelect:(e,a)=>(async(t,e,a)=>{if(Lt.isCanUse||Lt.isSupportProjectTrebleCustomDotBlackList)if(!Lt.isSupportProjectTrebleCustomDotBlackList||Lt.isEnableProjectTrebleCustomDotBlackList){if("cleanCustomRule"===t){const t=ft.create({title:"想清除自定义规则吗？",type:"warning",preset:"dialog",content:()=>m("p",null,[B("清除自定义规则后，将恢复")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(a.name,a.applicationName)])," ",B("的窗口控制器显示效果。确定要继续吗？")]),positiveText:"确定清除",negativeText:"我再想想",onPositiveClick:async()=>{t.loading=!0,Lt.customDotBlackList=Lt.customDotBlackList.filter(t=>t!==a.name),Lt.sourceDotBlackList=Lt.sourceDotBlackList.map(t=>(t.dataList=t.dataList.filter(t=>t!==a.name),t));const e=Lt.mergeDotBlackList.map(t=>t.name),[l,o]=await w(Lt.isSupportProjectTrebleCustomDotBlackList?h({dotBlackList:e,systemDotBlackList:Lt.projectTrebleSystemDotBlackList,customDotBlackList:Lt.customDotBlackList}):C({dotBlackList:e,sourceDotBlackList:Lt.sourceDotBlackList,customDotBlackList:Lt.customDotBlackList}));l?(ft.create({title:"清除自定义规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，清除失败了QwQ，详细错误请查看错误日志~")])}),t.loading=!1):(t.loading=!1,ft.create({title:"清除自定义规则成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("好耶w，清除自定义规则成功了OwO~实际生效还需要重启")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("系统界面")])," ",B("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){D().then(async t=>{await ht(),ft.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})}).catch(t=>{ft.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}),t.loading=!1,await ht())}})}if("shareCustomRule"===t){const t={name:a.name,cmpt:1,rules:{name:a.name},type:"dot_black_list",device:"tablet"===gt.deviceType?"pad":"fold"},e=JSON.stringify(t),l=K.deflate(e,{level:9,memLevel:9,windowBits:15}),o=new Uint8Array(l),s=E(o),[i]=await w(navigator.clipboard.writeText(`我分享了一个[窗口控制器]的自定义规则，可以前往[完美横屏应用计划 For Web UI]导入：\n${s}`));if(i)return void ft.create({title:"复制分享口令失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("复制")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(a.name,a.applicationName)])," ",B("的分享口令失败了QwQ，可能由于没有读取/写入剪切板的权限或")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("自定义规则")])," ",B("长度过大。")]),negativeText:"确定"});ft.create({title:"复制分享口令成功",type:"success",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("好耶w，复制")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(a.name,a.applicationName)])," ",B("分享口令成功了~")]),m("p",null,[B("如果没有复制成功，请确认是否给予了读取/写入剪切板的权限或")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("自定义规则")])," ",B("长度过大。")]),m("p",null,[B("分享口令导入入口位于")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("窗口控制器- 从分享口令导入")])," ",B("。")])]),positiveText:"确定"})}}else ft.create({title:"未激活 窗口控制器 3.0",type:"warning",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("未激活窗口控制器 3.0，先激活功能才能使用哦~")])])});else ft.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==gt.currentRootManager&&m("p",null,[B("部分"),gt.currentRootManager,B("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})})(e,0,t),size:"large",trigger:"click",options:e},{default:()=>[m(g("n-button"),{size:"small",dashed:!0,type:"info"},{default:()=>[B("自定义规则")],...a})]})}return m(g("n-button"),{size:"small",dashed:!0,type:"error",onClick:()=>(t=>{ft.create({title:"系统规则说明",type:"warning",preset:"dialog",content:()=>m("p",null,[B("系统已对")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(t.name,t.applicationName)])," ",B("配置了窗口控制器的隐藏，且不可被移除，仅有自定义规则可以被移除哦~")])})})(t)},{default:()=>[B("系统规则")],...a})}}],gt=c(),mt=S(),kt=Q(),yt=p(()=>({theme:gt.isDarkMode?I:U})),{message:bt,modal:ft,notification:vt}=z(["message","modal","notification"],{configProviderProps:yt}),Lt=e(),wt=r(!1),xt=r(!1);A();const Dt=r(null);a(),d(),l();const Bt=r("");function Tt(t,e){return()=>M(H,{size:e},{default:()=>M(t)})}const ht=async()=>{Lt.isCanUse||Lt.isSupportProjectTrebleCustomDotBlackList?!Lt.isSupportProjectTrebleCustomDotBlackList||Lt.isEnableProjectTrebleCustomDotBlackList?(await gt.getAndroidApplicationPackageNameList(),await Lt.initDefault()):ft.create({title:"未激活 窗口控制器 3.0",type:"warning",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("未激活窗口控制器 3.0，先激活功能才能使用哦~")])])}):ft.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==gt.currentRootManager&&m("p",null,[B("部分"),gt.currentRootManager,B("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})},Ct=()=>{Lt.filterInstalledApps=!Lt.filterInstalledApps},_t=async()=>{if(Lt.isCanUse||Lt.isSupportProjectTrebleCustomDotBlackList)if(!Lt.isSupportProjectTrebleCustomDotBlackList||Lt.isEnableProjectTrebleCustomDotBlackList){if(Dt.value){const[t,e]=await w(Dt.value.openDrawer());if(t)console.log("操作取消:",t);else{Lt.customDotBlackList.push(e.name);const t=Lt.mergeDotBlackList.map(t=>t.name),[a,l]=await w(Lt.isSupportProjectTrebleCustomDotBlackList?h({dotBlackList:t,systemDotBlackList:Lt.projectTrebleSystemDotBlackList,customDotBlackList:Lt.customDotBlackList}):C({dotBlackList:t,sourceDotBlackList:Lt.sourceDotBlackList,customDotBlackList:Lt.customDotBlackList}));a?(ft.create({title:"应用添加失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，添加失败了QwQ，详细错误请查看错误日志~")])}),e.loadingCallback&&e.loadingCallback()):(ft.create({title:"应用添加成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("好耶w，已经成功配置")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(e.name,gt.installedAppNameList[e.name]||Lt.applicationName[e.name])])," ",B("的窗口控制器隐藏效果了OwO~实际生效还需要重启")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("系统界面")])," ",B("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){D().then(async t=>{await ht(),ft.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})}).catch(t=>{ft.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}),await ht(),e.loadingCallback&&e.loadingCallback(),e.closeCallback&&e.closeCallback())}}}else ft.create({title:"未激活 窗口控制器 3.0",type:"warning",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("未激活窗口控制器 3.0，先激活功能才能使用哦~")])])});else ft.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==gt.currentRootManager&&m("p",null,[B("部分"),gt.currentRootManager,B("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})},Mt=u({page:1,pageSize:10,simple:!0,showSizePicker:!0,onChange:t=>{Mt.page=t},onUpdatePageSize:t=>{Mt.pageSize=t,Mt.page=1}}),jt=({focused:t,checked:e})=>{const a={};return e?(a.background="#2080f0",t&&(a.boxShadow="0 0 0 2px #2080f040")):(a.background="#d03050",t&&(a.boxShadow="0 0 0 2px #d0305040")),a};return(e,a)=>{const l=g("n-alert"),n=g("n-skeleton"),r=g("n-switch"),c=g("n-input-group"),p=g("n-card"),d=g("n-data-table");return s(),o("main",lt,[i("div",ot,[i("div",st,[a[10]||(a[10]=i("h3",{class:k("text-base font-semibold leading-7")},[i("span",{class:"animated-bg bg-clip-text font-semibold text-transparent",style:{"background-image":"linear-gradient(\r\n\t\t\t\t\t\t\t\t101.22deg,\r\n\t\t\t\t\t\t\t\trgb(255, 182, 133) -18.32%,\r\n\t\t\t\t\t\t\t\trgb(255, 111, 29) 7.01%,\r\n\t\t\t\t\t\t\t\trgb(252, 181, 232) 41.59%,\r\n\t\t\t\t\t\t\t\trgb(135, 148, 255) 70.98%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 91.35%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 110.17%\r\n\t\t\t\t\t\t\t)"}},"窗口控制器")],-1)),i("p",{class:k("mt-1 max-w-2xl text-sm leading-6 "+(y(gt).isDarkMode?"text-gray-300":"text-gray-500"))}," 窗口控制器，控制应用顶栏窗口控制器的显示或隐藏。 ",2)])]),m(p,{size:"small"},{default:b(()=>[y(gt).androidTargetSdk<35&&!1===y(Lt).isSupportProjectTrebleCustomDotBlackList?(s(),o("div",it,[m(l,{"show-icon":!0,type:"warning"},{default:b(()=>a[11]||(a[11]=[i("p",null,"经过测试效果在Hyper OS 1和基于Android 14的Hyper OS 2+体验不佳，极易被云控覆盖。",-1),i("p",null,"功能可以继续使用，但是不再对Hyper OS 1和基于Android 14的Hyper OS 2+下窗口控制器的缺陷和需求进行响应。",-1)])),_:1,__:[11]})])):f("",!0),"tablet"===y(gt).deviceType&&!0===y(Lt).isSupportProjectTrebleCustomDotBlackList?(s(),o("div",nt,[m(l,{"show-icon":!1,type:"info"},{default:b(()=>[i("p",null,"您的 "+v(y(gt).isInstalledXiaomiPadSystemPatchAdditionalModule?"附加模块":"移植包")+" 已适配窗口控制器 3.0，您可以选择激活该功能，激活后将获得更自由的自定义窗口控制器适配体验~",1),i("div",rt,[y(Lt).isInit?(s(),L(r,{key:1,"rail-style":jt,value:y(Lt).isEnableProjectTrebleCustomDotBlackList,loading:y(gt).loading||y(Lt).loading,"onUpdate:value":a[0]||(a[0]=async t=>{const[e]=await y(w)(x(t?1:0));e?y(ft).create({title:"更新激活状态失败",type:"error",preset:"dialog",content:()=>"更新激活状态失败，出现未知异常，详细请查看日志~",negativeText:"确定"}):(y(Lt).isEnableProjectTrebleCustomDotBlackList=t,y(ft).create({title:"更新激活状态成功",type:"success",preset:"dialog",content:()=>y(Lt).isEnableProjectTrebleCustomDotBlackList?"已成功激活窗口控制器 3.0，可以自定义更多应用的窗口控制器了~实际生效还需要重载系统界面作用域，是否继续？":"已成功禁用窗口控制器 3.0，仅使用系统内置的黑名单规则~实际生效还需要重载系统界面作用域，是否继续？",positiveText:"确定重载作用域",negativeText:"稍后再说",async onPositiveClick(){const[t]=await y(w)(D());t&&y(ft).create({title:"操作失败",type:"error",preset:"dialog",content:()=>"无法重启系统界面作用域，详情请查看日志记录~",negativeText:"确定"})}}))})},{checked:b(()=>a[12]||(a[12]=[B("已激活 窗口控制器 3.0")])),unchecked:b(()=>a[13]||(a[13]=[B("未激活 窗口控制器 3.0")])),_:1},8,["value","loading"])):(s(),L(n,{key:0,width:160,sharp:!1,round:"",size:"small"}))])]),_:1})])):f("",!0),i("div",ct,[m(y(N),{class:"mb-3 mr-3",type:"info",loading:y(gt).loading||y(Lt).loading,onClick:_t},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(V))]),_:1})]),default:b(()=>[a[14]||(a[14]=B(" 添加应用 "))]),_:1,__:[14]},8,["loading"]),m(y(N),{class:"mb-3 mr-3",type:"success",loading:y(gt).loading||y(Lt).loading,onClick:a[1]||(a[1]=()=>ht())},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(F))]),_:1})]),default:b(()=>[a[15]||(a[15]=B(" 刷新应用列表 "))]),_:1,__:[15]},8,["loading"]),m(y(N),{class:"mb-3 mr-3",color:"#8a2be2",loading:y(gt).loading||y(Lt).loading,onClick:a[2]||(a[2]=()=>(async()=>{if(!Lt.isCanUse&&!Lt.isSupportProjectTrebleCustomDotBlackList)return void ft.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==gt.currentRootManager&&m("p",null,[B("部分"),gt.currentRootManager,B("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])});if(Lt.isSupportProjectTrebleCustomDotBlackList&&!Lt.isEnableProjectTrebleCustomDotBlackList)return void ft.create({title:"未激活 窗口控制器 3.0",type:"warning",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("未激活窗口控制器 3.0，先激活功能才能使用哦~")])])});xt.value=!0,await ht();const t=Lt.mergeDotBlackList.map(t=>t.name),[e,a]=await w(Lt.isSupportProjectTrebleCustomDotBlackList?h({dotBlackList:t,systemDotBlackList:Lt.projectTrebleSystemDotBlackList,customDotBlackList:Lt.customDotBlackList}):C({dotBlackList:t,sourceDotBlackList:Lt.sourceDotBlackList,customDotBlackList:Lt.customDotBlackList}));e&&(ft.create({title:"热重载应用数据失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("热重载应用数据失败了QwQ，详情请查看错误日志~")]),negativeText:"确定"}),xt.value=!1),a&&(ft.create({title:"热重载应用数据成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("好耶w，已经重新为你载入包括自定义规则在内的应用数据~实际生效还需要重启")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("系统界面")])," ",B("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){D().then(async t=>{await ht(),ft.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})}).catch(t=>{ft.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}),xt.value=!1)})())},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(J))]),_:1})]),default:b(()=>[a[16]||(a[16]=B(" 热重载应用数据 "))]),_:1,__:[16]},8,["loading"]),m(y(N),{class:"mb-3 mr-3",color:"#69b2b6",loading:y(gt).loading||y(Lt).loading||y(kt).loading.value,onClick:a[3]||(a[3]=t=>(async()=>{const[t,e]=await w(kt.getList());t&&ft.create({title:"获取失败",type:"warning",preset:"dialog",content:()=>m("p",null,[B("您的系统环境暂不支持该功能，获取失败~")]),negativeText:"确定"}),e&&ft.create({title:"获取成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("好耶OwO，已重新获取当前已安装的应用名称~")]),negativeText:"确定"})})())},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y($))]),_:1})]),default:b(()=>[a[17]||(a[17]=B(" 获取已安装应用名称 "))]),_:1,__:[17]},8,["loading"]),m(y(N),{class:"mb-3 mr-3",type:"warning",loading:y(gt).loading||y(Lt).loading||wt.value,onClick:a[4]||(a[4]=t=>(async()=>{if(!Lt.isCanUse&&!Lt.isSupportProjectTrebleCustomDotBlackList)return void ft.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==gt.currentRootManager&&m("p",null,[B("部分"),gt.currentRootManager,B("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])});if(Lt.isSupportProjectTrebleCustomDotBlackList&&!Lt.isEnableProjectTrebleCustomDotBlackList)return void ft.create({title:"未激活 窗口控制器 3.0",type:"warning",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("未激活窗口控制器 3.0，先激活功能才能使用哦~")])])});Bt.value="";const[,t]=await w(new Promise((t,e)=>{ft.create({title:"请粘贴分享口令",preset:"dialog",style:"min-width:500px; width:50%;",class:"responsive-modal",content:()=>M(R,{type:"textarea",value:Bt.value,"onUpdate:value":t=>{Bt.value=t},autosize:{minRows:8,maxRows:8},placeholder:"在此处粘贴分享规则口令"}),positiveText:"确定提交",negativeText:"取消导入",onPositiveClick(){t("positiveClick")}})}));if(t){wt.value=!0;const t=Bt.value,a=j(t);if(!a?.length)return ft.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("导入分享规则失败了QwQ，解析")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("自定义规则")])," ",B("口令发生错误，无法正常解析。")]),negativeText:"确定"}),void(wt.value=!1);try{const t=O(a),e=K.inflate(t,{to:"string"}),l=JSON.parse(e);if("dot_black_list"!==l.type)return ft.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("导入分享规则失败了QwQ，该")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("自定义规则")])," ",B("不适用于窗口控制器。")]),negativeText:"确定"}),void(wt.value=!1);if("pad"===l.device&&"tablet"!==gt.deviceType||"fold"===l.device&&"tablet"===gt.deviceType)return ft.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("导入分享规则失败了QwQ，平板和折叠屏的适配规则不能混用哦~")]),negativeText:"确定"}),void(wt.value=!1);if(Lt.allPackageName.has(l.name))return ft.create({title:"应用包名已存在",type:"error",preset:"dialog",content:()=>m("p",null,[B("这个应用包名已经存在列表中了,导入分享规则失败了！（敲")])}),void(wt.value=!1);Lt.customDotBlackList.push(l.name);const o=Lt.mergeDotBlackList.map(t=>t.name),[s,i]=await w(Lt.isSupportProjectTrebleCustomDotBlackList?h({dotBlackList:o,systemDotBlackList:Lt.projectTrebleSystemDotBlackList,customDotBlackList:Lt.customDotBlackList}):C({dotBlackList:o,sourceDotBlackList:Lt.sourceDotBlackList,customDotBlackList:Lt.customDotBlackList}));s?(ft.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，导入失败了QwQ，详细错误请查看错误日志~")])}),wt.value=!1):(await ht(),mt.updateMergeRuleList(),wt.value=!1,ft.create({title:"导入分享规则成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("好耶w，")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[P(l.name,gt.installedAppNameList[l.name]||mt.applicationName[l.name])])," ",B("的应用配置成功了OwO~实际生效还需要重启")," ",m("span",{class:"font-bold "+(gt.isDarkMode?"text-teal-400":"text-gray-600")},[B("系统界面")])," ",B("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){D().then(async t=>{await ht(),ft.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>m("p",null,[B("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})}).catch(t=>{ft.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}))}catch(e){console.log(e,"error"),ft.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("解析分享规则失败了QwQ，请检查导入口令是否有误")]),negativeText:"确定"}),wt.value=!1}}})())},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(Y))]),_:1})]),default:b(()=>[a[18]||(a[18]=B(" 从分享口令导入 "))]),_:1,__:[18]},8,["loading"]),y(Lt).isSupportProjectTrebleCustomDotBlackList?f("",!0):(s(),L(y(N),{key:0,class:"mb-3 mr-3",type:"error",loading:y(gt).loading||y(Lt).loading||wt.value,onClick:a[5]||(a[5]=t=>(async()=>{const[t,e]=await w(new Promise((t,e)=>{ft.create({title:"想重启设备吗？",type:"info",preset:"dialog",content:()=>m("div",null,[m("p",null,[B("是否立即重启设备，以使规则生效？")])]),positiveText:"确认重启",negativeText:"取消",onPositiveClick:()=>{t("positiveClick")},onNegativeClick:()=>{e("negativeClick")}})}));if(e){const[t]=await w(_());if(t)return void ft.create({title:"操作失败",type:"error",preset:"dialog",content:()=>m("p",null,[B("无法重启设备，详情请查看日志记录~")]),negativeText:"确定"})}})())},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(at))]),_:1})]),default:b(()=>[a[19]||(a[19]=B(" 重启设备 "))]),_:1,__:[19]},8,["loading"]))]),i("div",pt,[m(y(N),{class:"mb-3 mr-3",type:y(Lt).filterInstalledApps?"success":"info",strong:"",loading:y(gt).loading||y(Lt).loading,secondary:"",onClick:Ct},{icon:b(()=>[m(y(H),null,{default:b(()=>[y(Lt).filterInstalledApps?(s(),L(y(Z),{key:0})):(s(),L(y(X),{key:1}))]),_:1})]),default:b(()=>[B(" "+v(y(Lt).filterInstalledApps?"已安装应用":"全部应用"),1)]),_:1},8,["type","loading"]),m(y(N),{class:"mb-3 mr-3",type:"warning",secondary:"",loading:y(gt).loading||y(Lt).loading,onClick:a[6]||(a[6]=()=>T())},{icon:b(()=>[m(y(H),null,{default:b(()=>a[20]||(a[20]=[i("img",{src:t},null,-1)])),_:1,__:[20]})]),default:b(()=>[a[21]||(a[21]=B(" 应用抽屉 "))]),_:1,__:[21]},8,["loading"])]),m(c,null,{default:b(()=>[m(y(R),{size:"large",clearable:"",value:y(Lt).searchKeyWord,"onUpdate:value":a[7]||(a[7]=t=>y(Lt).searchKeyWord=t),ref_key:"searchKeyWordInput",ref:dt,placeholder:"搜索应用名称/应用包名",style:{width:"80%"}},null,8,["value"]),m(y(N),{size:"large",type:"primary",onClick:a[8]||(a[8]=()=>{dt.value?.blur()})},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(tt))]),_:1})]),default:b(()=>[a[22]||(a[22]=i("span",{class:"hidden sm:inline-block"},"搜索",-1))]),_:1,__:[22]}),m(y(N),{size:"large",bordered:"",onClick:a[9]||(a[9]=()=>{y(Lt).searchKeyWord=""})},{icon:b(()=>[m(y(H),null,{default:b(()=>[m(y(et))]),_:1})]),default:b(()=>[a[23]||(a[23]=i("span",{class:"hidden sm:inline-block"},"搜索",-1))]),_:1,__:[23]})]),_:1})]),_:1}),m(d,{size:"small",loading:y(gt).loading||y(Lt).loading,columns:y(ut),class:"mt-3",data:y(Lt).filterMergeDotBlackList,pagination:Mt},null,8,["loading","columns","data","pagination"]),m(W,{ref_key:"addDotBlackListApp",ref:Dt,type:"add",title:"添加应用"},null,512)])}}});export{dt as default};
